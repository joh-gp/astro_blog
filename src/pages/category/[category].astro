---
//component import
import MainLayout from "../../layouts/MainLayout.astro";
import PostCard from "../../components/PostCard.astro";


//utils import
import {slugify, formatBlogPosts} from "../../js/utils";
import postcss from "postcss";

const allPosts = await Astro.glob("../blog/*.md");
const formattedPosts = formatBlogPosts(allPosts, {
	filterOutDrafts: true,
	filterOutFuturePosts: true,
	sortByDate: true,
	limit: 3,
});



export async function getStaticPaths() {
    return [
        {
            params: {category: slugify("Reference Docs")},
            props: {name: "Reference Docs"},
        },
        {
            params: {category: slugify("General")},
            props: {name: "General"},
        },
        {
            params: {category: slugify("CSS")},
            props: {name: "CSS"},
        },
        {
            params: {category: slugify("Astro")},
            props: {name: "Astro"},
        }
    ]
}

const {category} = Astro.params;
const {name} = Astro.props;

const catPosts = formattedPosts.filter((post) => slugify(post.frontmatter.category) === category);
---

<MainLayout title={name}>
	<section class="container" aria-label="new Blog Posts">
		<h1 class="h1">Posts about <span>{name}</span></h1>
		<div class="post-container">
			{
				catPosts.map((post) => (
				<PostCard
					frontmatter={post.frontmatter}
					url={post.url}
					tagType="h2"
				/>
				))
				/* <PostCard frontmatter={allPosts[0].frontmatter} url={allPosts[0].url} tagType="h2"/>
				) */
			}
		</div>
	</section>
</MainLayout>